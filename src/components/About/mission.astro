---
import { remark } from 'remark';
import html from 'remark-html';
import fs from 'fs/promises';
import matter from 'gray-matter';

const missionData = await fs.readFile('./src/content/mission/mission.md', 'utf-8');
const { content, data } = matter(missionData);

const processedContent = await remark().use(html).process(content);
const contentHtml = processedContent.toString();

const missionSections = data.sections || [];
export async function loader() {
    const missionData = await fs.readFile('./src/content/mission/mission.md', 'utf-8');
    const { content, data } = matter(missionData);

    const processedContent = await remark().use(html).process(content);
    const contentHtml = processedContent.toString();

    return {
        contentHtml,
        sections: data.sections.slice(2) // Skip the first two sections
    };
}
---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About</title>
    <link rel="stylesheet" href="/assets/css/About/mission.css">
</head>
<body>
    <div class="mission-container">
        <img class="mission-img" src="/assets/img/hero/hero.jpg" alt="Image">
        <div class="mission-text-box" dangerouslySetInnerHTML={{ __html: contentHtml }}></div>
    </div>
    <div class="mission-container">
        {missionSections.map(section => (
            <div class="mission-text-box">
                {section.text}
            </div>
        ))}
    </div>
    <div class="mission-container">
        <div class="mission-title">OUR MISSION AND VISION</div>
        <div class="mission-card-container">
            <!-- Display filtered mission sections -->
            {props.sections.map(section => (
                <div class="mission-card">
                    <div class="mission-icon"></div>
                    <div class="mission-card-title">{section.title || ''}</div>
                    <div class="mission-card-desc">{section.description || ''}</div>
                </div>
            ))}
        </div>
    </div>
</body>
</html>
