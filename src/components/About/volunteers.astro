---
import { remark } from 'remark';
import html from 'remark-html';
import fs from 'fs/promises';
import matter from 'gray-matter';

const volunteerData = await fs.readFile('./src/content/volunteers/volunteers.md', 'utf-8');
const { content, data } = matter(volunteerData);

const processedContent = await remark().use(html).process(content);
const contentHtml = processedContent.toString();

const volunteers = data.volunteers || [];

const showHighPriorityOnly = Astro.props.showHighPriorityOnly ?? false;
const filteredVolunteers = volunteers
    .filter(volunteer => !showHighPriorityOnly || volunteer.priority === "high")
    .sort((a, b) => a.name.localeCompare(b.name));
const volunteersToDisplay = showHighPriorityOnly ? filteredVolunteers.slice(0, 3) : filteredVolunteers;
---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About</title>
    <link rel="stylesheet" href="/assets/css/About/volunteer.css">
</head>
<body>
    <div class="volunteers-c1">
        <div class="volunteers-c1-title">Meet our Volunteers</div>
        <div class="volunteers-c1-card-container">
            {volunteersToDisplay.length > 0 ? (
                volunteersToDisplay.map(volunteer => (
                    <div class="volunteers-c1-card">
                        <img src={volunteer.image} alt={`Image of ${volunteer.name}`} />
                        <div class="volunteers-c1-card-title1">{volunteer.name}</div>
                        <div class="volunteers-c1-card-title2">{volunteer.role}</div>
                        <div class="volunteers-c1-card-description">{volunteer.description}</div>
                    </div>
                ))
            ) : (
                <div class="volunteers-c1-card-title1">No volunteers available</div>
            )}
        </div>
    </div>
</body>
</html>
